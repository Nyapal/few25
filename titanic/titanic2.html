<html>
  <head>
    <title>Titanic Dataset | Viz 2</title>
    <link rel="stylesheet" href="titanic2.css">
  </head>
  <body>
    <h1 style="text-align:center">Visualization 2</h1>

    <h3> Embarked </h3>
    <p> 
      Southhampton <span class="sh-square"></span>,
      Cherbourg <span class="cb-square"></span>,
      Queenstown  <span class="qs-square"></span>,
      Unknown  <span class="undefined-square"></span>
    </p>
    <div id="totalPassengers"></div>

    <h3> Classes </h3>
    <p>
      First <span class="fClass"></span>,
      Second <span class="sClass"></span>,
      Third <span class="tClass"></span>
    </p>
    <div id="pClass"></div>

    <h3> Gender </h3>
    <p>
      Male <span class="male"></span>,
      Female <span class="female"></span>
    </p>
    <div id="gender"></div>
    <!-- male vs female -->

    <h3> Survivors </h3>
    <div id="survivors"></div>
    <!-- dead vs alive -->

    <hr style="margin-top: 25px; border: 2px solid black;">
    
    <h2> Challenges </h2>

    <p> Sort based on gender, survived, embarked, & both sex & survived </p>
    
    <script>

      const totalPassengers = document.getElementById('totalPassengers')
      const pClass = document.getElementById('pClass')
      const gender = document.getElementById('gender')
      const survivorsGraph = document.getElementById('survivors')

      fetch('passengers.json')
      .then(res => res.json())
      .then(json => {
        handleData(json)
      })

      function handleData(data) {
        const betterData = data.map(passengers => passengers.fields)
        embarked(betterData)
        passClass(betterData)
        genderGraph(betterData)
        survivors(betterData)

        console.log(betterData)

        //STYLE 
        totalPassengers.style.display = 'flex'
        totalPassengers.style.flexWrap = 'wrap'
        pClass.style.display = 'flex'
        pClass.style.flexWrap = 'wrap'
        gender.style.display = 'flex'
        gender.style.flexWrap = 'wrap'
        survivorsGraph.style.display = 'flex'
        survivorsGraph.style.flexWrap = 'wrap'
      }

      function embarked(betterData) {
        betterData.sort((a, b) => a.embarked === 'C' ? -1 : 1)
        betterData.sort((a, b) => a.embarked === 'S' ? -1 : 1)
        // EMBARKED
        betterData.forEach(passenger => {
          //make an element
          const el = document.createElement('div')
          //attach the element to the dom 
          totalPassengers.appendChild(el)
          //styling element 
          el.style.width = '10px'
          el.style.height = '10px'
          el.style.margin = '1px'
          
          if (passenger.embarked === 'S') {
            el.style.backgroundColor = 'red'
          } else if (passenger.embarked === 'Q') {
            el.style.backgroundColor = 'blue'
          } else if (passenger.embarked === 'C') {
            el.style.backgroundColor = 'silver'
          } else {
            el.style.backgroundColor = 'black'
          }
        })


      }

      function passClass(betterData) {
        betterData.sort((a, b) => a.pclass === 2 ? -1 : 1)
        betterData.sort((a, b) => a.pclass === 1 ? -1 : 1)
        //CLASS
        betterData.forEach(passenger => {
          //make an element 
          const el = document.createElement('div')
          //attach the element to the dom 
          pClass.appendChild(el)
          //style element 
          el.style.width = '10px'
          el.style.height = '10px'
          el.style.margin = '1px'

          if(passenger.pclass === 1) {
            el.style.backgroundColor = 'gold'
          } else if (passenger.pclass === 2) {
            el.style.backgroundColor = 'silver' 
          } else if (passenger.pclass === 3) {
            el.style.backgroundColor = '#B87333'
          } else {
            el.style.backgroundColor = 'black'
          }
        })
      }

      function genderGraph (betterData) {
        betterData.sort((a, b) => {
          if (a.sex === 'male') {
            return -1
          } else {
            return 1
          }
          // return a.sex === 'male' ? -1 : 1
        })

        console.log(betterData.map(p => p.sex))

        betterData.forEach(passenger => {
          //make an element
          const el = document.createElement('div')
          //attach the element to the dom 
          gender.appendChild(el)
          //styling element 
          el.style.width = '10px'
          el.style.height = '10px'
          el.style.margin = '1px'
          
          el.style.backgroundColor = passenger.sex === 'male' ? 'blue' : 'pink'
        }) 
      }

      function survivors (betterData) {
        betterData.sort((a, b) => a.survived === 'Yes' ? -1: 1)
        betterData.forEach(passenger => {
          //make an element
          const el = document.createElement('div')
          //attach the element to the dom 
          survivorsGraph.appendChild(el)
          //styling element 
          el.style.width = '10px'
          el.style.height = '10px'
          el.style.margin = '1px'
          
          el.style.backgroundColor = passenger.survived === 'No' ? 'red' : 'blue'
        }) 

      }
    </script>
  </body>
</html>